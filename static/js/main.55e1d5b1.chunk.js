(this["webpackJsonpenglish-fight-ui"]=this["webpackJsonpenglish-fight-ui"]||[]).push([[0],{221:function(e,t,n){e.exports={errorMessage:"AppWrapper_errorMessage__SHeX2"}},394:function(e,t,n){},401:function(e,t,n){},402:function(e,t,n){},403:function(e,t,n){},405:function(e,t,n){},406:function(e,t,n){},407:function(e,t,n){},410:function(e,t,n){"use strict";n.r(t);n(280),n(306),n(308),n(309),n(311),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348);var r=n(1),a=n(0),c=n.n(a),i=n(202),s=n(9),o=n.n(s),u=n(17),l=n(6),j=n(8),d=function(){function e(){Object(l.a)(this,e)}return Object(j.a)(e,null,[{key:"waitForTimeout",value:function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,t)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"waitTillTimestamp",value:function(){var t=Object(u.a)(o.a.mark((function t(n){var r,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(new Date).getTime(),!((a=n-r)>0)){t.next=4;break}return t.abrupt("return",e.waitForTimeout(a));case 4:return t.abrupt("return",Promise.resolve());case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}();d.isProductionMode=!0,d.isE2E=!1;var b=n(418),f=n(57),p=n.n(f);function h(e){var t=e.children;return d.isProductionMode?Object(r.jsx)(b.a,{fallback:function(e){var t=e.error,n=e.componentStack,a=e.resetError;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0442\u0440\u0438\u0441\u043e\u0432\u043a\u0438:"}),Object(r.jsx)("p",{children:t.message}),Object(r.jsx)("p",{children:n}),Object(r.jsx)(p.a,{onClick:a,children:"\u041f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0435\u0449\u0435 \u0440\u0430\u0437"})]})},children:t}):t}var O=n(15),v=n(127),x=n(205),m=n(160),g=n(206),k=n.n(g),y=n(45),w=n(207),S=n.n(w),N=n(21),_=n.n(N),C=n(106),E=n.n(C),T=n(208),B=n.n(T);function F(e){return function(t){return S()(t,e)}}function A(e,t){return this.constructor.update(this,Object(y.a)({},e,{$set:t}))}var R=new Map;function M(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object(N.struct)(e,{name:t,defaultProps:n});return r.fromObject=F(r),r.prototype.set=A,R.set(t,r),r}var P,G,U=function(){function e(){Object(l.a)(this,e)}return Object(j.a)(e,null,[{key:"getSearchParam",value:function(e){return new URLSearchParams(window.location.search).get(e)}},{key:"getHashParam",value:function(e){return new URLSearchParams(window.location.hash.slice(1)).get(e)}}]),e}(),q=n(209),D=n.n(q),I="https://english-fight-api.up.railway.app",L=I.includes("https://")?"wss://":"ws://",H="\u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044f\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430",W={3e3:"\u041d\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d"},Q=3001,z=3002,K=function(){function e(){Object(l.a)(this,e)}return Object(j.a)(e,null,[{key:"post",value:function(){var t=Object(u.a)(o.a.mark((function t(n,r){var a,c,i,s,u,l,j,d=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=d.length>2&&void 0!==d[2]?d[2]:{},c=a.sendToken,i=void 0===c||c,s=a.expand,u=void 0===s?"":s,l=a.Model,j=void 0===l?null:l,t.abrupt("return",e.send(n,{data:e.convertDataToBackendFormat(r),sendToken:i,method:"POST",expand:u,Model:j}));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"patch",value:function(){var t=Object(u.a)(o.a.mark((function t(n,r){var a,c,i,s,u,l,j,d=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=d.length>2&&void 0!==d[2]?d[2]:{},c=a.sendToken,i=void 0===c||c,s=a.expand,u=void 0===s?"":s,l=a.Model,j=void 0===l?null:l,t.abrupt("return",e.send(n,{data:e.convertDataToBackendFormat(r),sendToken:i,method:"PATCH",expand:u,Model:j}));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"get",value:function(){var t=Object(u.a)(o.a.mark((function t(n){var r,a,c,i,s,u=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=u.length>1&&void 0!==u[1]?u[1]:{},a=r.expand,c=void 0===a?"":a,i=r.Model,s=void 0===i?null:i,t.abrupt("return",e.send(n,{sendToken:!0,method:"GET",expand:c,Model:s}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"send",value:function(){var t=Object(u.a)(o.a.mark((function t(n,r){var a,c,i,s,u,l,j,d,b,f;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.data,c=r.sendToken,i=r.method,s=r.expand,u=r.Model,l=void 0===u?null:u,j=new URLSearchParams,s&&(d=k()(s).join(","),j.append("expand",d)),b={headers:e.createHeaders({sendToken:c})},"GET"!==i&&(b.mode="cors",b.body=JSON.stringify(a)),b.method=i,t.next=8,Object(x.timeout)(fetch(e.createFullApiURL(n,j),b),1e4);case 8:return f=t.sent,t.abrupt("return",e.processResponse(f,l));case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"openSocketConnection",value:function(t,n){var r=n.onMessage,a=void 0===r?function(){}:r,c=n.onOpen,i=void 0===c?function(){}:c,s=n.onClose,o=void 0===s?function(){}:s,u=n.onError,l=void 0===u?function(){}:u,j=Object(v.a)(n,["onMessage","onOpen","onClose","onError"]),d=e.createFullSocketURL(t),b=function(e){var t=W[e.code]||H;throw W[e.code]||console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0435\u0431\u0441\u043e\u043a\u0435\u0442\u0430 #".concat(e.code)),new Error(t)},f=new WebSocket(d);f.addEventListener("message",(function(t){var n=JSON.parse(t.data),r=null;if(n.instance){var c=function(e){var t=B()(E()(e));if(!R.has(t))throw new Error('No model with name "'.concat(t,'" (converted from "').concat(e,'") found'));return R.get(t)}(n.model);r=e.convertDataToFrontendFormat(n.instance,c)}var i=null;n.data&&(i=e.convertDataToFrontendFormat(n.data));var s=E()(n.type),o=Object.prototype.hasOwnProperty.call(j,s),u={type:n.type,data:i,instance:r};o&&j[s](u),a(u)})),f.addEventListener("close",b),f.addEventListener("close",o),f.addEventListener("error",(function(){throw new Error("\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f")})),f.addEventListener("error",l);var p=f.close;f.close=function(){f.removeEventListener("close",b);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];p.apply(f,t)},f.sendJson=function(e){f.send(JSON.stringify(e))},f.sendEvent=function(e,t){this.sendJson(D()({type:e,data:t},(function(e){return e})))};var h=f;return f.addEventListener("open",(function(){h.sendEvent("authenticate",{authorization:e.getAuthorizationHeader()})})),f.addEventListener("open",i),h}},{key:"createHeaders",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.sendToken,r={Accept:"application/json","Content-Type":"application/json"};return n&&(r.Authorization=e.getAuthorizationHeader()),r}},{key:"getAuthorizationHeader",value:function(){if(U.getSearchParam("fake_vk_id")){if(d.isProductionMode)throw new Error("You cannot use fake_vk_id in production");return e.getFakeVKIDAuthHeader()}return e.getQueryStringAuthHeader()}},{key:"getQueryStringAuthHeader",value:function(){var e=window.location.search.slice(1);return"QueryString ".concat(e)}},{key:"getFakeVKIDAuthHeader",value:function(){var e=U.getSearchParam("fake_vk_id");return"FakeVKID ".concat(e)}},{key:"createFullApiURL",value:function(t,n){return e.createFullUrl("api/".concat(t),n)}},{key:"createFullSocketURL",value:function(t){var n="ws/".concat(t),r=e.removeTrailingSlash(I);return r=r.slice(r.indexOf("://")+3),"".concat(L).concat(r,"/").concat(n)}},{key:"createFullUrl",value:function(t,n){var r=e.removeTrailingSlash(I),a="".concat(r,"/").concat(t);return n&&String(n)&&(a+="?".concat(String(n))),a}},{key:"processResponse",value:function(){var t=Object(u.a)(o.a.mark((function t(n){var r,a,c=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=c.length>1&&void 0!==c[1]?c[1]:null,!(n.status>=500&&n.status<600)){t.next=3;break}throw new Error(H);case 3:return t.prev=3,t.next=6,n.json();case 6:a=t.sent,t.next=12;break;case 9:throw t.prev=9,t.t0=t.catch(3),new Error("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430");case 12:if(n.ok){t.next=16;break}if(!a.detail){t.next=15;break}throw new Error(a.detail);case 15:throw new Error("\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f");case 16:return t.abrupt("return",e.convertDataToFrontendFormat(a,r));case 17:case"end":return t.stop()}}),t,null,[[3,9]])})));return function(e){return t.apply(this,arguments)}}()},{key:"convertDataToBackendFormat",value:function(e){return Object(m.toSnake)(e)}},{key:"convertDataToFrontendFormat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Object(m.toCamel)(e);return t?t.fromObject(n):n}},{key:"removeTrailingSlash",value:function(e){return e.endsWith("/")?e.slice(0,-1):e}}]),e}(),V=n(18),J=n(27),X=Object(N.irreducible)("Null",(function(e){return null===e})),Y=Object(N.refinement)(_.a.Number,(function(e){return e>=0}),"PositiveNumber"),Z=Object(N.refinement)(_.a.Number,(function(e){return e>=1}),"ID"),$={ALLOW:"allow",BLOCK:"block",TO_BE_REQUESTED:"to be requested"},ee="word",te="picture";!function(e){e.single="single",e.multi="multi"}(P||(P={})),function(e){e.bright_light="bright_light",e.space_gray="space_gray"}(G||(G={}));var ne=function(e){Object(V.a)(n,e);var t=Object(J.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return n}(M({id:Z,vkId:Z,firstName:_.a.String,lastName:_.a.String,photoUrl:_.a.String,score:Y,monthlyScore:Y,foreverRank:Y,monthlyRank:Y,notificationsStatus:_.a.enums.of(Object.values($),"notificationsStatus")},"User")),re=n(61),ae=n.n(re),ce=n(7),ie=function(e){return Object(ce.a)({AUTOMATIC_OPERATIONS:["*"]},e)},se=ie({init:function(){return Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Init tracker");case 1:case"end":return e.stop()}}),e)})))()},identify:function(e,t){return Object(u.a)(o.a.mark((function n(){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:console.log("linked session with userId ".concat(e,", vkId ").concat(t));case 1:case"end":return n.stop()}}),n)})))()},reachGoal:function(e,t){return Object(u.a)(o.a.mark((function n(){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t?console.log("Reach goal ".concat(e," with params"),t):console.log("Reach goal ".concat(e));case 1:case"end":return n.stop()}}),n)})))()}}),oe={AUTOMATIC_OPERATIONS:["init"],init:function(){var e=document.createElement("script");e.type="application/javascript",e.async=!0,e.src="https://vk.com/js/api/openapi.js?168",e.onload=function(){window.VK.Retargeting.Init("VK-RTRG-801543-7s37b"),window.VK.Retargeting.Hit()},document.head.appendChild(e)},reachGoal:function(e){d.isProductionMode&&window.VK.Goal(e)}},ue=n(99),le=n.n(ue),je=ie({init:function(){return Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:le.a.init("e93996ec9d92068567adf6bbb49e3e79",{api_host:"https://dimadk24-mp-proxy.up.railway.app"});case 1:case"end":return e.stop()}}),e)})))()},identify:function(e,t){return Object(u.a)(o.a.mark((function n(){var r;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r={"vk id":t,"utm source":U.getHashParam("utm_source")||""},le.a.identify(String(e)),le.a.people.set_once(r),le.a.register_once(r);case 4:case"end":return n.stop()}}),n)})))()},reachGoal:function(e,t){return Object(u.a)(o.a.mark((function n(){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:le.a.track(e,t);case 1:case"end":return n.stop()}}),n)})))()}}),de=d.isProductionMode?[oe,je]:[se];function be(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];de.forEach((function(t){("*"===t.AUTOMATIC_OPERATIONS[0]||t.AUTOMATIC_OPERATIONS.includes(e))&&t[e].apply(t,n)}))}var fe=function(e,t){be("identify",e,t)},pe=function(){be("init")},he=function(e,t){be("reachGoal",e,t)},Oe=function(){function e(){Object(l.a)(this,e)}return Object(j.a)(e,null,[{key:"fetchUserData",value:function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K.get("user",{Model:ne}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"allowNotifications",value:function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return he("allow-notifications"),e.abrupt("return",K.patch("user",{notificationsStatus:$.ALLOW},{Model:ne}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"blockNotifications",value:function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return he("block-notifications"),e.abrupt("return",K.patch("user",{notificationsStatus:$.BLOCK},{Model:ne}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"requestNotifications",value:function(){var t=Object(u.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.areNotificationsEnabledOnVkSide){t.next=2;break}return t.abrupt("return",e.allowNotifications());case 2:return t.prev=2,t.next=5,ae.a.send("VKWebAppAllowNotifications");case 5:if(n=t.sent,!n.result){t.next=9;break}return t.abrupt("return",e.allowNotifications());case 9:t.next=16;break;case 11:if(t.prev=11,t.t0=t.catch(2),"client_error"!==t.t0.error_type||!t.t0.error_data||4!==t.t0.error_data.error_code||"User denied"!==t.t0.error_data.error_reason){t.next=15;break}return t.abrupt("return",e.blockNotifications());case 15:throw t.t0;case 16:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(){return t.apply(this,arguments)}}()}]),e}();Oe.areNotificationsEnabledOnVkSide=Boolean(parseInt(U.getSearchParam("vk_are_notifications_enabled"),10));var ve=n(431),xe=new(n(430).a)({defaultOptions:{queries:{refetchOnWindowFocus:!1}}}),me=["user"],ge=function(){return Object(ve.a)({queryKey:me,queryFn:Oe.fetchUserData,staleTime:1/0})},ke=function(e){return xe.setQueryData(me,e)};function ye(e){var t=e.children,n=ge(),r=n.isSuccess,c=n.data,i=r&&c.id,s=r&&c.vkId,l=r&&c.notificationsStatus;return Object(a.useEffect)((function(){r&&function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l!==$.ALLOW||Oe.areNotificationsEnabledOnVkSide){e.next=6;break}return e.t0=ke,e.next=4,Oe.blockNotifications();case 4:e.t1=e.sent,(0,e.t0)(e.t1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[r,l]),Object(a.useEffect)((function(){r&&fe(i,s)}),[r,i,s]),t}var we=n(49),Se=n(220),Ne=n.n(Se),_e=(n(393),n(394),n(12)),Ce=function(e){Object(V.a)(n,e);var t=Object(J.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return n}(M({id:Z,question:_.a.String,answerWords:_.a.list(_.a.String),correctAnswer:_.a.union([X,_.a.String]),selectedAnswer:_.a.union([X,_.a.String]),isCorrect:_.a.Boolean},"Question")),Ee=_.a.union([Ce,_.a.Number]);Ee.dispatch=function(e){return"number"===typeof e?_.a.Number:Ce};var Te=function(e){Object(V.a)(n,e);var t=Object(J.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return n}(M({id:Z,questions:_.a.list(Ee),points:_.a.Number},"Game")),Be=function(){function e(){Object(l.a)(this,e)}return Object(j.a)(e,null,[{key:"startSinglePlayerGame",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.post("game_definition",{type:t});case 2:return n=e.sent,e.abrupt("return",K.post("game",{gameDefinition:n.id},{expand:"questions",Model:Te}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitQuestion",value:function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K.patch("question/".concat(t.id),{selectedAnswer:t.selectedAnswer},{Model:Ce}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBattle",value:function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K.get("game/".concat(t),{expand:"questions",Model:Te}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Fe=n(93),Ae=n.n(Fe),Re=n(71),Me=n.n(Re),Pe=n(125),Ge=n.n(Pe),Ue=n(124),qe=n.n(Ue),De=n(214),Ie=n.n(De),Le=n(213),He=n.n(Le);var We=function(){return Object(_e.C)()===_e.m?Object(r.jsx)(He.a,{}):Object(r.jsx)(Ie.a,{})};function Qe(e){var t=e.panelHeaderProps,n=e.onBackButtonClick,a=e.text,c=e.showBackButton,i=Object(ce.a)({},t);return i.left=c?Object(r.jsx)(_e.s,{onClick:n,children:Object(r.jsx)(We,{})}):void 0,Object(r.jsx)(_e.r,Object(ce.a)(Object(ce.a)({},i),{},{children:a}))}Qe.defaultProps={panelHeaderProps:{},showBackButton:!0,onBackButtonClick:function(){}};var ze,Ke=function(e){var t=e.delay,n=void 0===t?200:t,c=e.render,i=void 0===c?function(){return Object(r.jsx)(_e.t,{size:"large"})}:c,s=Object(a.useState)(!1),o=Object(O.a)(s,2),u=o[0],l=o[1];return Object(a.useEffect)((function(){var e=setTimeout((function(){l(!0)}),n);return function(){clearTimeout(e)}}),[n]),u?i():null},Ve=n(420),Je=n(421),Xe=function(e){var t=e.onStartSingleGame,n=e.onStartMultiplayerGame,c=ge().data,i=Object(a.useState)(!1),s=Object(O.a)(i,2),l=s[0],j=s[1],d=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.checked,j(!0),e.prev=2,!n){e.next=9;break}return e.next=6,Oe.requestNotifications();case 6:r=e.sent,e.next=12;break;case 9:return e.next=11,Oe.blockNotifications();case 11:r=e.sent;case 12:ke(r);case 13:return e.prev=13,j(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[2,,13,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Qe,{text:"English Clash",showBackButton:!1}),c&&Object(r.jsx)(Ae.a,{children:Object(r.jsx)(Me.a,{before:c.photoUrl?Object(r.jsx)(qe.a,{src:c.photoUrl}):null,description:Object(r.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(r.jsxs)("span",{children:["\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0447\u043a\u043e\u0432 - ",c.score]})," ",Object(r.jsxs)("span",{children:["\u041c\u0435\u0441\u0442\u043e \u0432 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0435: ",c.foreverRank]})]}),multiline:!0,"data-testid":"user-info",children:"".concat(c.firstName," ").concat(c.lastName)})}),Object(r.jsx)(Ae.a,{children:Object(r.jsxs)(Ge.a,{children:[Object(r.jsx)(Me.a,{children:Object(r.jsx)(p.a,{before:Object(r.jsx)(Ve.a,{}),size:"xl",onClick:t,disabled:l,children:"\u041d\u0430\u0447\u0430\u0442\u044c \u043e\u0434\u0438\u043d\u043e\u0447\u043d\u0443\u044e \u0438\u0433\u0440\u0443"})}),Object(r.jsx)(Me.a,{children:Object(r.jsx)(p.a,{before:Object(r.jsx)(Je.a,{}),size:"xl",onClick:n,disabled:l,mode:"secondary",children:"\u0418\u0433\u0440\u0430\u0442\u044c \u0441 \u0434\u0440\u0443\u0433\u043e\u043c"})})]})}),c&&Object(r.jsx)(Ae.a,{children:Object(r.jsx)(Me.a,{multiline:!0,indicator:Object(r.jsx)(_e.w,{checked:c.notificationsStatus===$.ALLOW,onChange:d,disabled:l}),children:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043e\u0431 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f\u0445"})}),Object(r.jsx)(Ae.a,{children:Object(r.jsx)(Me.a,{children:Object(r.jsx)(_e.o,{href:"https://vk.me/english_clash",target:"_blank",children:"\u0421\u0432\u044f\u0437\u044c \u0441 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u043c"})})}),l&&Object(r.jsx)(Ke,{})]})},Ye=(n(401),n(215)),Ze=function(){function e(){Object(l.a)(this,e)}return Object(j.a)(e,null,[{key:"createFullPictureUrl",value:function(t){var n=e.removePrecedingSlash(t);return K.createFullUrl(n)}},{key:"removePrecedingSlash",value:function(e){return e.startsWith("/")?e.slice(1):e}}]),e}(),$e=Object(a.createContext)(G.bright_light),et=(ze={},Object(y.a)(ze,ee,(function(e){return Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(_e.l,{weight:"semibold",className:"word-question",style:{fontSize:"20px",padding:"16px 0",textAlign:"center"},children:e})})})),Object(y.a)(ze,te,(function(e){return Object(r.jsx)("div",{className:"picture-question",children:Object(r.jsx)("div",{className:"picture-wrapper",children:Object(r.jsx)("img",{src:Ze.createFullPictureUrl(e),alt:"\u041a\u0430\u0440\u0442\u0438\u043d\u043a\u0430 \u0441 \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u043c"})})})})),ze);var tt=function(e){var t=e.question,n=e.gameType,c=e.onSelectAnswer,i=t.answerWords,s=t.selectedAnswer,o=t.isCorrect,u=t.correctAnswer,l=t.question,j=et[n],d=Object(a.useContext)($e)===G.bright_light?"primary":"secondary";return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(_e.j,{children:j(l)}),Object(r.jsx)(Ge.a,{children:i.map((function(e){var t=e===u,n=!o&&e===s,a=Object(Ye.a)("answer-button",{correct:t,failure:n});return Object(r.jsx)(p.a,{size:"xl",mode:d,stretched:!0,className:a,onClick:function(){return!s&&c(e)},children:e},e)}))})]})},nt="setBattle",rt="updateQuestion",at="goToNextQuestion",ct={battle:null,activeQuestion:null,hasNextQuestion:!1};function it(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case nt:var n=t.payload,r=n.questions;return Object(ce.a)(Object(ce.a)({},e),{},{battle:n,activeQuestion:r[0],hasNextQuestion:r.length>1});case rt:var a=t.payload,c=e.battle.questions,i=c.findIndex((function(e){return e.id===a.id})),s=[].concat(Object(we.a)(c.slice(0,i)),[a],Object(we.a)(c.slice(i+1)));return Object(ce.a)(Object(ce.a)({},e),{},{battle:Object(ce.a)(Object(ce.a)({},e.battle),{},{questions:s}),activeQuestion:a});case at:var o=e.battle.questions,u=o.findIndex((function(t){return t.id===e.activeQuestion.id}));if(u===o.length-1)throw new Error("\u0412\u044b \u0443\u0436\u0435 \u043d\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u043c \u0432\u043e\u043f\u0440\u043e\u0441\u0435");var l=u+1;return Object(ce.a)(Object(ce.a)({},e),{},{activeQuestion:o[l],hasNextQuestion:l<o.length-1});default:return e}}var st=n(216),ot=(n(402),function(e){var t=e.onGoBack,n=e.onFinishGame,c=e.gameType,i=void 0===c?null:c,s=e.gameMode,l=void 0===s?null:s,j=e.game,b=void 0===j?null:j,f=Object(a.useState)(!1),p=Object(O.a)(f,2),h=p[0],v=p[1],x=Object(a.useReducer)(it,ct),m=Object(O.a)(x,2),g=m[0],k=m[1],y=g.battle,w=g.activeQuestion,S=g.hasNextQuestion,N=Object(a.useState)(0),_=Object(O.a)(N,2),C=_[0],E=_[1],T=Object(a.useState)(!1),B=Object(O.a)(T,2),F=B[0],A=B[1];Object(a.useEffect)((function(){b&&(k({type:nt,payload:b}),l===P.multi?E(3):A(!0))}),[b,l]);var R=y&&!F?1e3:null;Object(st.a)((function(){1===C?A(!0):E(C-1)}),R);var M=function(){var e=Object(u.a)(o.a.mark((function e(t){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h){e.next=2;break}return e.abrupt("return");case 2:return r=w.set("selectedAnswer",t),v(!0),e.prev=4,e.next=7,Be.submitQuestion(r);case 7:a=e.sent,k({type:rt,payload:a});case 9:return e.prev=9,v(!1),e.finish(9);case 12:return e.next=14,d.waitForTimeout(1e3);case 14:S?k({type:at}):n(y);case 15:case"end":return e.stop()}}),e,null,[[4,,9,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Qe,{onBackButtonClick:t,text:"\u0418\u0433\u0440\u0430"}),F&&w&&Object(r.jsx)(tt,{question:w,onSelectAnswer:M,gameType:i}),!F&&Object(r.jsxs)(_e.g,{className:"start-game-timer",children:["\u0414\u043e \u043d\u0430\u0447\u0430\u043b\u0430 \u0438\u0433\u0440\u044b: ",C]}),h&&Object(r.jsx)(Ke,{})]})}),ut=n(129),lt=n.n(ut),jt=n(219),dt=n.n(jt),bt=(n(403),n(218)),ft=n.n(bt),pt=n(422),ht=n(217),Ot=n.n(ht);var vt=function(e){return Object(r.jsx)(p.a,Object(ce.a)(Object(ce.a)({size:"l",before:Object(r.jsx)(Ot.a,{})},e),{},{children:"\u0414\u043e\u043c\u043e\u0439"}))};var xt=function(e){var t=e.onGoBack,n=e.battle,c=void 0===n?null:n,i=e.onRetry,s=ge().data,l=c.questions,j=c.points,d=l.filter((function(e){return e.isCorrect})).length,b=l.length-d,f=Object(a.useState)(!1),h=Object(O.a)(f,2),v=h[0],x=h[1],m=Object(a.useState)(!1),g=Object(O.a)(m,2),k=g[0],y=g[1],w=s.notificationsStatus===$.TO_BE_REQUESTED,S=Object(r.jsxs)("div",{className:"action-buttons-wrapper",children:[Object(r.jsx)(vt,{onClick:t}),Object(r.jsx)(p.a,{onClick:i,size:"l",before:Object(r.jsx)(ft.a,{}),children:"\u0415\u0449\u0435 \u0440\u0430\u0437"})]});function N(){return(N=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!k){e.next=2;break}return e.abrupt("return");case 2:return y(!0),e.prev=3,e.next=6,Oe.requestNotifications();case 6:t=e.sent,ke(t),t.notificationsStatus===$.BLOCK&&x(!0);case 9:return e.prev=9,y(!1),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[3,,9,12]])})))).apply(this,arguments)}function _(){return C.apply(this,arguments)}function C(){return(C=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!k){e.next=2;break}return e.abrupt("return");case 2:return y(!0),e.prev=3,e.t0=ke,e.next=7,Oe.blockNotifications();case 7:e.t1=e.sent,(0,e.t0)(e.t1),x(!0);case 10:return e.prev=10,y(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[3,,10,13]])})))).apply(this,arguments)}var E=Object(r.jsx)(_e.d,{style:{marginTop:"10px"},children:Object(r.jsx)(_e.c,{size:"l",style:{padding:"10px"},children:Object(r.jsxs)("div",{className:"notification-request-content",children:[Object(r.jsx)("span",{className:"notification-request-header",children:"\u0423\u0437\u043d\u0430\u0439 \u043f\u0435\u0440\u0432\u044b\u043c \u043e\u0431 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f\u0445 - \u043f\u043e\u0434\u043f\u0438\u0448\u0438\u0441\u044c \u043d\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f!"}),Object(r.jsxs)("div",{className:"notification-buttons-wrapper",children:[Object(r.jsx)(p.a,{size:"m",mode:"commerce",className:"notification-button",onClick:function(){return N.apply(this,arguments)},disabled:k,children:"\u041f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f"}),Object(r.jsx)(p.a,{size:"m",mode:"secondary",className:"notification-button",onClick:_,disabled:k,children:"\u041d\u0435 \u0441\u0435\u0439\u0447\u0430\u0441"})]}),Object(r.jsx)("span",{className:"notification-request-close",children:Object(r.jsx)(pt.a,{onClick:_})}),Object(r.jsx)("span",{className:"notification-request-subtext",children:"\u0412\u0441\u0435\u0433\u0434\u0430 \u043c\u043e\u0436\u043d\u043e \u043e\u0442\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u043e\u043c \u044d\u043a\u0440\u0430\u043d\u0435"})]})})});return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Qe,{text:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b",onBackButtonClick:t}),Object(r.jsxs)(Ae.a,{header:Object(r.jsx)(dt.a,{mode:"secondary",children:"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430"}),children:[Object(r.jsx)(Me.a,{indicator:Object(r.jsx)(lt.a,{mode:"primary",children:d}),children:"\u0412\u0435\u0440\u043d\u044b\u0445 \u043e\u0442\u0432\u0435\u0442\u043e\u0432:"}),Object(r.jsx)(Me.a,{indicator:Object(r.jsx)(lt.a,{mode:"primary",children:b}),children:"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0445 \u043e\u0442\u0432\u0435\u0442\u043e\u0432:"}),Object(r.jsx)(Me.a,{indicator:Object(r.jsx)(lt.a,{mode:"primary",children:j}),children:"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e \u043e\u0447\u043a\u043e\u0432:"})]}),!w&&S,w&&E,v&&Object(r.jsx)(_e.g,{className:"subscribe-later",children:"\u041f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f \u043c\u043e\u0436\u043d\u043e \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u043e\u043c \u044d\u043a\u0440\u0430\u043d\u0435"}),k&&Object(r.jsx)(Ke,{})]})},mt=n(427),gt=n(428),kt=function(e){Object(V.a)(n,e);var t=Object(J.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return n}(M({id:Z,firstName:_.a.String,lastName:_.a.String,photoUrl:_.a.String,score:Y},"ScoreboardUser"));n(405);var yt=function(e){var t=e.rank,n=e.score,a=e.photoUrl,c=e.firstName,i=e.lastName;return Object(r.jsx)(_e.u,{before:Object(r.jsx)(_e.f,{children:t}),after:n,children:Object(r.jsxs)("div",{className:"scoreboard-item",children:[Object(r.jsx)(_e.a,{size:40,src:a}),Object(r.jsxs)("div",{className:"scoreboard-item-name",children:[c," ",i]})]})})},wt="forever",St="monthly";function Nt(){var e=ge().data,t=Object(a.useState)([]),n=Object(O.a)(t,2),c=n[0],i=n[1],s=Object(a.useState)(!1),l=Object(O.a)(s,2),j=l[0],d=l[1],b=Object(a.useState)(wt),f=Object(O.a)(b,2),p=f[0],h=f[1],v=Object(a.useState)(!1),x=Object(O.a)(v,2),m=x[0],g=x[1];return Object(a.useEffect)((function(){(function(){var t=Object(u.a)(o.a.mark((function t(){var n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i([]),d(!0),t.next=4,K.get("".concat(p,"_scoreboard"));case 4:n=t.sent,r=kt.fromObject(Object(ce.a)({},e)),g(Boolean(n.find((function(e){return e.id===r.id})))),i(n),d(!1);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[p,e]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Qe,{text:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433",showBackButton:!1}),Object(r.jsx)(_e.i,{vertical:"top",children:Object(r.jsxs)(_e.z,{children:[Object(r.jsx)(_e.A,{selected:p===wt,onClick:function(){return h(wt)},children:"\u0417\u0430 \u0432\u0441\u0435 \u0432\u0440\u0435\u043c\u044f"}),Object(r.jsx)(_e.A,{selected:p===St,onClick:function(){return h(St)},children:"\u0417\u0430 \u043c\u0435\u0441\u044f\u0446"})]})}),Object(r.jsx)(_e.g,{children:Object(r.jsxs)(_e.j,{style:{paddingTop:"20px"},children:[!j&&Object(r.jsxs)(_e.p,{children:[c.map((function(e,t){var n=e.id,a=e.firstName,c=e.lastName,i=e.photoUrl,s=e.score;return Object(r.jsx)(yt,{rank:t+1,score:s,photoUrl:i,firstName:a,lastName:c},n)})),!m&&Object(r.jsx)(yt,{rank:p===wt?e.foreverRank:e.monthlyRank,score:p===wt?e.score:e.monthlyScore,photoUrl:e.photoUrl,firstName:e.firstName,lastName:e.lastName})]}),j&&Object(r.jsx)(Ke,{})]})})]})}var _t=n(423),Ct=n(424);var Et=function(e){var t=e.onGoBack,n=e.onChoose;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Qe,{text:"\u0422\u0438\u043f \u0438\u0433\u0440\u044b",onBackButtonClick:t}),Object(r.jsx)(_e.j,{header:Object(r.jsx)(_e.k,{mode:"primary",children:"\u0412\u044b\u0431\u0435\u0440\u0438 \u0442\u0438\u043f \u0438\u0433\u0440\u044b:"}),children:Object(r.jsxs)(_e.p,{children:[Object(r.jsx)(_e.e,{before:Object(r.jsx)(_t.a,{}),expandable:!0,onClick:function(){return n(te)},children:"\u041a\u0430\u0440\u0442\u0438\u043d\u043a\u0430"}),Object(r.jsx)(_e.e,{before:Object(r.jsx)(Ct.a,{}),expandable:!0,onClick:function(){return n(ee)},children:"\u041f\u0435\u0440\u0435\u0432\u043e\u0434"})]})})]})},Tt=n(425),Bt=n(426),Ft=(n(406),K.removeTrailingSlash("https://vk.com/app7717529"));var At=function(e){var t=e.gameDefinition,n=e.onGoBack,c=Object(a.useState)(!1),i=Object(O.a)(c,2),s=i[0],l=i[1];if(!t)return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Qe,{text:"\u0418\u0433\u0440\u0430 \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438",onBackButtonClick:n}),Object(r.jsx)(Ke,{})]});var j="".concat(Ft,"#gid=").concat(t.id),d=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae.a.send("VKWebAppCopyText",{text:t});case 2:l(!0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.a.send("VKWebAppShare",{link:j});case 3:e.next=10;break;case 5:if(e.prev=5,e.t0=e.catch(0),"client_error"===e.t0.error_type&&e.t0.error_data&&4===e.t0.error_data.error_code&&"User denied"===e.t0.error_data.error_reason){e.next=10;break}throw e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Qe,{text:"\u0418\u0433\u0440\u0430 \u0441 \u0434\u0440\u0443\u0433\u043e\u043c",onBackButtonClick:n}),Object(r.jsx)(_e.j,{children:Object(r.jsxs)(_e.g,{children:[Object(r.jsxs)("div",{className:"method-wrapper",children:[Object(r.jsx)("div",{className:"invite-help-text",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u044c \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0443 \u044d\u0442\u0443 \u0441\u0441\u044b\u043b\u043a\u0443, \u0447\u0442\u043e\u0431\u044b \u043e\u043d(\u0430) \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u043b\u0441\u044f \u043a \u0438\u0433\u0440\u0435"}),Object(r.jsxs)("div",{className:"input-wrapper",children:[Object(r.jsx)(_e.n,{className:"invite-url-input",value:j,readOnly:!0}),Object(r.jsx)(_e.b,{onClick:function(){return d(j)},className:"copy-button",before:Object(r.jsx)(Tt.a,{}),children:Object(r.jsx)("span",{className:"button-subtitle",children:"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})}),Object(r.jsx)(_e.b,{onClick:b,className:"share-button",before:Object(r.jsx)(Bt.a,{}),children:Object(r.jsx)("span",{className:"button-subtitle",children:"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f"})})]})]}),Object(r.jsxs)("div",{className:"method-wrapper second-method",children:[Object(r.jsx)("div",{className:"invite-help-text",children:"\u0415\u0449\u0435 \u043c\u043e\u0436\u043d\u043e \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043f\u043e ID \u0438\u0433\u0440\u044b"}),Object(r.jsxs)("div",{className:"input-wrapper",children:[Object(r.jsx)(_e.n,{className:"invite-url-input",value:t.id,readOnly:!0}),Object(r.jsx)(_e.b,{onClick:function(){return d(t.id)},className:"copy-button",before:Object(r.jsx)(Tt.a,{}),children:Object(r.jsx)("span",{className:"button-subtitle",children:"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})})]})]}),Object(r.jsxs)("div",{className:"loader-wrapper",children:[Object(r.jsx)(Ke,{}),Object(r.jsx)("span",{className:"loader-caption",children:"\u041e\u0436\u0438\u0434\u0430\u0435\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0432\u0442\u043e\u0440\u043e\u0433\u043e \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430"})]}),s&&Object(r.jsx)(_e.v,{onClose:function(){return l(!1)},duration:3e3,children:"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e"})]})})]})},Rt=function(e){Object(V.a)(n,e);var t=Object(J.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return n}(M({id:_.a.String,creator:Z,players:_.a.list(Z),type:_.a.String},"GameDefinition"));var Mt=function(e){var t=e.onCreateNew,n=e.onJoin,a=e.onGoBack;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Qe,{text:"\u0418\u0433\u0440\u0430 \u0441 \u0434\u0440\u0443\u0433\u043e\u043c",onBackButtonClick:a}),Object(r.jsx)(_e.j,{children:Object(r.jsxs)(_e.p,{children:[Object(r.jsx)(_e.e,{onClick:t,expandable:!0,children:"\u041d\u0430\u0447\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0438\u0433\u0440\u0443"}),Object(r.jsx)(_e.e,{onClick:n,expandable:!0,children:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043a \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0439"})]})})]})};n(407);var Pt=function(e){var t=e.onJoin,n=e.onBack,c=Object(a.useState)(""),i=Object(O.a)(c,2),s=i[0],o=i[1];return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Qe,{text:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043a \u0438\u0433\u0440\u0435",onBackButtonClick:n}),Object(r.jsxs)(_e.g,{children:[Object(r.jsx)("div",{className:"join-game-help-text",children:"ID \u0438\u0433\u0440\u044b:"}),Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t(s)},children:[Object(r.jsx)(_e.n,{onChange:function(e){o(e.target.value)}}),Object(r.jsx)(_e.g,{children:Object(r.jsx)(_e.b,{type:"submit",stretched:!0,size:"xl",disabled:!s.trim(),children:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f"})})]})]})]})},Gt=n(72),Ut=n.n(Gt);var qt=function(e){var t=e.onGoBack,n=e.items,a=e.playersNumber,c=2===a?"\u043e\u0436\u0438\u0434\u0430\u0435\u043c \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0438\u0433\u0440\u043e\u043a\u0430":"\u043e\u0436\u0438\u0434\u0430\u0435\u043c \u0434\u0440\u0443\u0433\u0438\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432";return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Qe,{text:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b",onBackButtonClick:t}),Object(r.jsxs)(_e.j,{children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(_e.e,{children:Object(r.jsxs)("div",{className:Ut.a.headerRow,children:[Object(r.jsx)("span",{className:Ut.a.nameHeader,children:"\u0418\u0433\u0440\u043e\u043a"}),Object(r.jsx)("span",{className:Ut.a.answersHeader,children:"\u0412\u0435\u0440\u043d\u044b\u0445 \u043e\u0442\u0432\u0435\u0442\u043e\u0432"}),Object(r.jsx)("span",{children:"\u0421\u0447\u0435\u0442"})]})}),n.map((function(e){var t=e.user,n=e.correctAnswersNumber,a=e.totalQuestions,c=e.points;return Object(r.jsx)(_e.e,{className:Ut.a.dataRowWrapper,children:Object(r.jsxs)("div",{className:Ut.a.dataRow,children:[Object(r.jsx)(qe.a,{src:t.photoUrl}),Object(r.jsx)("span",{className:Ut.a.name,children:t.firstName}),Object(r.jsxs)("span",{className:Ut.a.answers,children:[n," \u0438\u0437 ",a]}),Object(r.jsx)("span",{children:c})]})},t.id)}))]}),n.length<a&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ke,{}),Object(r.jsx)("div",{className:Ut.a.loaderText,children:c})]}),Object(r.jsx)("div",{className:Ut.a.homeButtonWrapper,children:Object(r.jsx)(vt,{onClick:t})})]})]})};var Dt=function(e){var t=e.popout,n=ge().isLoading,c=Object(a.useState)(!1),i=Object(O.a)(c,2),s=i[0],l=i[1],j=Object(a.useState)(!1),b=Object(O.a)(j,2),f=b[0],p=b[1],h=Object(a.useState)(!1),v=Object(O.a)(h,2),x=v[0],m=v[1],g=Object(a.useState)("game"),k=Object(O.a)(g,2),y=k[0],w=k[1],S=Object(a.useState)("home"),N=Object(O.a)(S,2),_=N[0],C=N[1],E=Object(a.useState)(null),T=Object(O.a)(E,2),B=T[0],F=T[1],A=Object(a.useState)(null),R=Object(O.a)(A,2),M=R[0],G=R[1],q=Object(a.useState)(null),D=Object(O.a)(q,2),I=D[0],L=D[1],H=function(e){var t=Object(a.useState)(e),n=Object(O.a)(t,2),r=n[0],c=n[1],i=Object(a.useRef)(e);return i.current=r,[r,Object(a.useCallback)((function(e){i.current=e,c(e)}),[]),i]}(null),W=Object(O.a)(H,3),V=W[0],J=W[1],X=W[2],Y=Object(a.useState)(null),Z=Object(O.a)(Y,2),$=Z[0],ee=Z[1],te=Object(a.useState)([]),ne=Object(O.a)(te,2),re=ne[0],ae=ne[1],ie=Object(a.useRef)(null),se=Object(a.useCallback)((function(e){var t=e.instance;J(t)}),[J]),ue=Object(a.useCallback)(function(){var e=Object(u.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.instance,ee(r),!n){e.next=6;break}return 900,e.next=6,d.waitTillTimestamp(n+900);case 6:C("battle");case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[]),le=Object(a.useCallback)((function(e){var t=e.instance,n=e.data;ae((function(e){return e.length===X.current.players.length-1&&ie.current.close(Q),[].concat(Object(we.a)(e),[Object(ce.a)({user:t},n)])}))}),[X,ie]);Object(a.useEffect)((function(){ae([])}),[V]);var je=Object(a.useCallback)(function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.prev=1,e.next=4,K.get("game_definition/".concat(t),{Model:Rt});case 4:n=e.sent,J(n),r=(new Date).getTime(),C("lobby"),G(n.type),ie.current=K.openSocketConnection("multiplayer-game/".concat(t),{joinedGame:se,startedGame:function(e){var t=e.instance;return ue({instance:t},r)},finishedGame:le}),e.next=19;break;case 12:if(e.prev=12,e.t0=e.catch(1),"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430."!==e.t0.message){e.next=18;break}throw new Error("\u0418\u0433\u0440\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");case 18:throw e.t0;case 19:return e.prev=19,l(!1),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[1,12,19,22]])})));return function(t){return e.apply(this,arguments)}}(),[ue,le,se,J]);Object(a.useEffect)((function(){var e=U.getHashParam("gid");e&&(je(e),L(P.multi))}),[]);var de=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be.getBattle(t.id);case 2:n=e.sent,F(n),C("results"),he("finish-game"),oe.reachGoal("conversion"),xe.invalidateQueries({queryKey:me});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),be=function(){return C("home")},fe=function(e){e!==I&&L(e),C("choose-game-type")};function pe(e){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.post("game_definition",{type:t},{Model:Rt});case 2:return n=e.sent,J(n),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ve=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,Be.startSinglePlayerGame(t);case 4:n=e.sent,ee(n);case 6:return e.prev=6,p(!1),e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[1,,6,9]])})));return function(t){return e.apply(this,arguments)}}(),ke=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==M&&G(t),I!==P.single){e.next=7;break}return e.next=4,ve(t);case 4:C("battle"),e.next=13;break;case 7:return n=pe(t),C("lobby"),e.next=11,n;case 11:r=e.sent,ie.current=K.openSocketConnection("multiplayer-game/".concat(r.id),{joinedGame:function(e){var t=e.instance;se({instance:t}),2===t.players.length&&(ie.current.sendEvent("start-game"),he("launch-multiplayer-game"))},startedGame:ue,finishedGame:le});case 13:he("start-game",{type:t,mode:I});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ye=n||s||f;Object(a.useEffect)((function(){var e;return ye?e=window.setTimeout((function(){m(!0)}),200):m(!1),function(){clearTimeout(e)}}),[ye]),Object(a.useEffect)((function(){I===P.multi&&"game"!==y&&ie.current.close(z)}),[y,ie,I]);var Se=null;return t?Se=t:ye&&x&&(Se=Object(r.jsx)(Ne.a,{})),Object(r.jsxs)(_e.h,{activeStory:y,tabbar:Object(r.jsxs)(_e.x,{children:[Object(r.jsx)(_e.y,{text:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f",selected:"game"===y,onClick:function(){w("game"),C("home")},children:Object(r.jsx)(mt.a,{})}),Object(r.jsx)(_e.y,{text:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433",selected:"scoreboard"===y,onClick:function(){w("scoreboard"),C("scoreboard-home")},children:Object(r.jsx)(gt.a,{})})]}),children:[Object(r.jsxs)(_e.B,{id:"game",activePanel:_,popout:Se,children:[Object(r.jsx)(_e.q,{id:"home",children:Object(r.jsx)(Xe,{onStartSingleGame:function(){return fe(P.single)},onStartMultiplayerGame:function(){L(P.multi),C("choose-multiplayer-game-action")}})}),Object(r.jsx)(_e.q,{id:"choose-multiplayer-game-action",children:Object(r.jsx)(Mt,{onCreateNew:function(){C("choose-game-type")},onJoin:function(){C("join-multiplayer-game")},onGoBack:be})}),Object(r.jsx)(_e.q,{id:"choose-game-type",children:Object(r.jsx)(Et,{onGoBack:function(){I===P.multi?C("choose-multiplayer-game-action"):be()},onChoose:ke})}),Object(r.jsx)(_e.q,{id:"join-multiplayer-game",children:Object(r.jsx)(Pt,{onJoin:function(e){je(e)},onBack:function(){C("choose-multiplayer-game-action")}})}),Object(r.jsx)(_e.q,{id:"lobby",children:Object(r.jsx)(At,{gameDefinition:V,onGoBack:function(){fe(I),ie.current.close(z)}})}),Object(r.jsx)(_e.q,{id:"battle",children:Object(r.jsx)(ot,{onGoBack:function(){fe(I),I===P.multi&&ie.current.close(z)},onFinishGame:de,gameType:M,gameMode:I,game:$})}),Object(r.jsxs)(_e.q,{id:"results",children:[I===P.single&&Object(r.jsx)(xt,{onRetry:function(){return ke(M)},onGoBack:be,battle:B}),I===P.multi&&Object(r.jsx)(qt,{onGoBack:function(){be(),ie.current.close(z)},items:re,playersNumber:V&&V.players.length||0})]})]}),Object(r.jsx)(_e.B,{id:"scoreboard",activePanel:_,popout:t,children:Object(r.jsx)(_e.q,{id:"scoreboard-home",children:Object(r.jsx)(Nt,{})})})]})},It=n(412),Lt=n(223),Ht=n.n(Lt),Wt=n(221),Qt=n.n(Wt),zt=n(429),Kt=n(225),Vt=n(222),Jt=function(){function e(){Object(l.a)(this,e)}return Object(j.a)(e,null,[{key:"getDevFlagsFrom",value:function(e){var t,n={},r=new URLSearchParams(e),a=Object(Vt.a)(r.entries());try{for(a.s();!(t=a.n()).done;){var c=Object(O.a)(t.value,2),i=c[0],s=c[1];if(i.startsWith("feature"))n[i.replace(/^feature_/,"")]=s}}catch(o){a.e(o)}finally{a.f()}return n}},{key:"getDevFeatureFlags",value:function(){return Object(ce.a)(Object(ce.a)({},e.getDevFlagsFrom(window.location.search)),e.getDevFlagsFrom(window.location.hash.slice(1)))}}]),e}();var Xt=function(e){var t=e.children,n=ge().data,a={core:{authorizationKey:"dsr9kgv3ebr47m7563n92hnr0tlj2auamp61",key:"anonymous"}};d.isProductionMode||(a.core.authorizationKey="localhost",a.features=Jt.getDevFeatureFlags());var c=n?String(n.vkId):"anonymous";return Object(r.jsx)(zt.a,{config:a,children:Object(r.jsx)(Kt.b,{splitKey:c,children:t})})},Yt=n(210),Zt=n(224);var $t=function(){var e=Object(a.useState)(null),t=Object(O.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(G.bright_light),s=Object(O.a)(i,2),o=s[0],u=s[1];return Object(a.useEffect)((function(){ae.a.send("VKWebAppInit"),ae.a.subscribe((function(e){var t=e.detail,n=t.type,r=t.data;"VKWebAppUpdateConfig"===n&&u(r.scheme||G.bright_light)}))}),[]),Object(a.useEffect)((function(){var e=document.createAttribute("scheme");e.value=o,document.body.attributes.setNamedItem(e)}),[o]),Object(a.useEffect)((function(){d.isProductionMode&&It.a({dsn:"https://ae49049c58d94887bed337d523675ca6@o158161.ingest.sentry.io/5554359",beforeSend:function(e,t){if(e.exception){var n=t&&t.originalException&&t.originalException instanceof Error&&t.originalException.message?t.originalException.message:"";c(Object(r.jsxs)(Ht.a,{actions:[{mode:"default",title:"\u041e\u041a",autoclose:!0}],onClose:function(){return c(null)},children:[Object(r.jsx)("h2",{children:"\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 =("}),n&&Object(r.jsx)("p",{className:Qt.a.errorMessage,children:n}),Object(r.jsx)("p",{children:"\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439 \u0435\u0449\u0435 \u0440\u0430\u0437"})]}))}return e}}),pe(),he("open app")}),[]),Object(r.jsxs)(Yt.a,{client:xe,children:[Object(r.jsx)(ye,{children:Object(r.jsx)(Xt,{children:Object(r.jsx)($e.Provider,{value:o,children:Object(r.jsx)(Dt,{popout:n})})})}),!d.isE2E&&Object(r.jsx)(Zt.a,{initialIsOpen:!1})]})};Object(i.render)(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(h,{children:Object(r.jsx)($t,{})})}),document.getElementById("root")),d.isProductionMode||d.isE2E||Promise.all([n.e(3),n.e(4)]).then(n.bind(null,435))},72:function(e,t,n){e.exports={headerRow:"MultiplayerResults_headerRow__y5pM1",answersHeader:"MultiplayerResults_answersHeader__3NEgp",nameHeader:"MultiplayerResults_nameHeader__Hh72X",dataRowWrapper:"MultiplayerResults_dataRowWrapper__yZ66X",dataRow:"MultiplayerResults_dataRow__2DcDp",name:"MultiplayerResults_name__og7Wz",answers:"MultiplayerResults_answers__Hnaj0",loaderText:"MultiplayerResults_loaderText__2FoPw",homeButtonWrapper:"MultiplayerResults_homeButtonWrapper__3ataf"}}},[[410,1,2]]]);
//# sourceMappingURL=main.55e1d5b1.chunk.js.map